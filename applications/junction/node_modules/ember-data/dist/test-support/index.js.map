{"version":3,"file":"index.js","sources":["../../src/test-support/index.ts"],"sourcesContent":["import type Owner from '@ember/owner';\nimport { render as renderTemplate, settled } from '@ember/test-helpers';\n\nimport * as QUnit from 'qunit';\n\nimport type Store from '@ember-data/store';\nimport { PRODUCTION } from '@warp-drive/build-config/env';\nimport { assert } from '@warp-drive/build-config/macros';\n\n/*\n  Temporary replacement for the render test helper\n  which we will deprecate in EmberData 5.0, this allows\n  an app to incrementally migrate to tests that render async\n  relationships in stages with potential for tests in between.\n*/\nexport async function render(template: object) {\n  await renderTemplate(template);\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n  const owner = QUnit.config.current.testEnvironment.owner as Owner;\n  const pending = (owner.lookup('service:store') as Store)._getAllPending();\n\n  // this should only be necessary in production tests\n  // where @ember/test-waiters is deactivated :()\n  if (PRODUCTION) {\n    assert(\n      `No pending requests exist in this test, use \\`import { render } from '@ember/test-helpers';\\``,\n      pending?.length\n    );\n\n    await pending;\n    await settled();\n  }\n}\n"],"names":["render","template","renderTemplate","owner","QUnit","config","current","testEnvironment","pending","lookup","_getAllPending","macroCondition","getGlobalConfig","WarpDrive","env","PRODUCTION","DEBUG","test","Error","length","settled"],"mappings":";;;;AAeO,eAAeA,MAAMA,CAACC,QAAgB,EAAE;EAC7C,MAAMC,QAAc,CAACD,QAAQ,CAAC,CAAA;AAC9B;EACA,MAAME,KAAK,GAAGC,KAAK,CAACC,MAAM,CAACC,OAAO,CAACC,eAAe,CAACJ,KAAc,CAAA;EACjE,MAAMK,OAAO,GAAIL,KAAK,CAACM,MAAM,CAAC,eAAe,CAAC,CAAWC,cAAc,EAAE,CAAA;;AAEzE;AACA;EACA,IAAAC,cAAA,CAAAC,eAAA,EAAA,CAAAC,SAAA,CAAAC,GAAA,CAAAC,UAAA,CAAgB,EAAA;IACdJ,cAAA,CAAAC,eAAA,EAAAC,CAAAA,SAAA,CAAAC,GAAA,CAAAE,KAAA,CAAA,GAAA,CAAAC,IAAA,IAAA;AAAA,MAAA,IAAA,CAAAA,IAAA,EAAA;QAAA,MAAAC,IAAAA,KAAA,CACE,CAA+F,6FAAA,CAAA,CAAA,CAAA;AAAA,OAAA;KAC/FV,EAAAA,OAAO,EAAEW,MAAM,CAAA,GAAA,EAAA,CAAA;AAGjB,IAAA,MAAMX,OAAO,CAAA;IACb,MAAMY,OAAO,EAAE,CAAA;AACjB,GAAA;AACF;;;;"}