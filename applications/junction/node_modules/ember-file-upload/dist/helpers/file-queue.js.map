{"version":3,"file":"file-queue.js","sources":["../../src/helpers/file-queue.ts"],"sourcesContent":["import Helper from '@ember/component/helper';\nimport { registerDestructor } from '@ember/destroyable';\nimport * as s from '@ember/service';\nimport type { UploadFile } from '../upload-file.ts';\nimport type FileQueueService from '../services/file-queue.ts';\nimport { DEFAULT_QUEUE } from '../services/file-queue.ts';\nimport type { FileQueueSignature, QueueListener } from '../interfaces.ts';\n\nconst service = s.service ?? s.inject;\n\n/**\n * `file-queue` helper is one of the core primitives of ember-file-upload.\n *\n * @example\n *\n * using the default queue (no `name` property)\n *\n * ```hbs\n * {{#let (file-queue) as |queue|}}\n *   {{queue.progress}}%\n * {{/let}}\n * ```\n *\n * @example\n *\n * named queue:\n *\n * ```hbs\n * {{#let (file-queue name=\"photos\") as |queue|}}\n *   {{queue.progress}}%\n * {{/let}}\n * ```\n */\nexport default class FileQueueHelper\n  extends Helper<FileQueueSignature>\n  implements QueueListener\n{\n  @service declare fileQueue: FileQueueService;\n\n  declare named: FileQueueSignature['Args']['Named'];\n\n  compute(\n    _positional: FileQueueSignature['Args']['Positional'],\n    named: FileQueueSignature['Args']['Named'],\n  ) {\n    this.named = named;\n    const queue = this.fileQueue.findOrCreate(named.name ?? DEFAULT_QUEUE);\n\n    queue.addListener(this);\n\n    registerDestructor(this, () => {\n      queue.removeListener(this);\n    });\n\n    return queue;\n  }\n\n  onFileAdded(file: UploadFile) {\n    this.named.onFileAdded?.(file);\n  }\n\n  onFileRemoved(file: UploadFile) {\n    this.named.onFileRemoved?.(file);\n  }\n\n  onUploadStarted(file: UploadFile) {\n    this.named.onUploadStarted?.(file);\n  }\n\n  onUploadSucceeded(file: UploadFile, response: Response) {\n    this.named.onUploadSucceeded?.(file, response);\n  }\n\n  onUploadFailed(file: UploadFile, response: Response) {\n    this.named.onUploadFailed?.(file, response);\n  }\n}\n"],"names":["service","s","inject","FileQueueHelper","_class","Helper","constructor","args","_initializerDefineProperty","_descriptor","compute","_positional","named","queue","fileQueue","findOrCreate","name","DEFAULT_QUEUE","addListener","registerDestructor","removeListener","onFileAdded","file","onFileRemoved","onUploadStarted","onUploadSucceeded","response","onUploadFailed","_applyDecoratedDescriptor","prototype","configurable","enumerable","writable","initializer"],"mappings":";;;;;;;AAQA,MAAMA,OAAO,GAAGC,CAAC,CAACD,OAAO,IAAIC,CAAC,CAACC,MAAM,CAAA;;AAErC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACqBC,IAAAA,eAAe,IAAAC,MAAA,GAArB,MAAMD,eAAe,SAC1BE,MAAM,CAEhB;AAAAC,EAAAA,WAAAA,CAAA,GAAAC,IAAA,EAAA;AAAA,IAAA,KAAA,CAAA,GAAAA,IAAA,CAAA,CAAA;AAAAC,IAAAA,0BAAA,oBAAAC,WAAA,EAAA,IAAA,CAAA,CAAA;AAAA,GAAA;AAKEC,EAAAA,OAAOA,CACLC,WAAqD,EACrDC,KAA0C,EAC1C;IACA,IAAI,CAACA,KAAK,GAAGA,KAAK,CAAA;AAClB,IAAA,MAAMC,KAAK,GAAG,IAAI,CAACC,SAAS,CAACC,YAAY,CAACH,KAAK,CAACI,IAAI,IAAIC,aAAa,CAAC,CAAA;AAEtEJ,IAAAA,KAAK,CAACK,WAAW,CAAC,IAAI,CAAC,CAAA;IAEvBC,kBAAkB,CAAC,IAAI,EAAE,MAAM;AAC7BN,MAAAA,KAAK,CAACO,cAAc,CAAC,IAAI,CAAC,CAAA;AAC5B,KAAC,CAAC,CAAA;AAEF,IAAA,OAAOP,KAAK,CAAA;AACd,GAAA;EAEAQ,WAAWA,CAACC,IAAgB,EAAE;AAC5B,IAAA,IAAI,CAACV,KAAK,CAACS,WAAW,GAAGC,IAAI,CAAC,CAAA;AAChC,GAAA;EAEAC,aAAaA,CAACD,IAAgB,EAAE;AAC9B,IAAA,IAAI,CAACV,KAAK,CAACW,aAAa,GAAGD,IAAI,CAAC,CAAA;AAClC,GAAA;EAEAE,eAAeA,CAACF,IAAgB,EAAE;AAChC,IAAA,IAAI,CAACV,KAAK,CAACY,eAAe,GAAGF,IAAI,CAAC,CAAA;AACpC,GAAA;AAEAG,EAAAA,iBAAiBA,CAACH,IAAgB,EAAEI,QAAkB,EAAE;IACtD,IAAI,CAACd,KAAK,CAACa,iBAAiB,GAAGH,IAAI,EAAEI,QAAQ,CAAC,CAAA;AAChD,GAAA;AAEAC,EAAAA,cAAcA,CAACL,IAAgB,EAAEI,QAAkB,EAAE;IACnD,IAAI,CAACd,KAAK,CAACe,cAAc,GAAGL,IAAI,EAAEI,QAAQ,CAAC,CAAA;AAC7C,GAAA;AACF,CAAC,EAAAjB,WAAA,GAAAmB,yBAAA,CAAAxB,MAAA,CAAAyB,SAAA,EAAA,WAAA,EAAA,CAvCE7B,OAAO,CAAA,EAAA;EAAA8B,YAAA,EAAA,IAAA;EAAAC,UAAA,EAAA,IAAA;EAAAC,QAAA,EAAA,IAAA;EAAAC,WAAA,EAAA,IAAA;AAAA,CAAA,CAAA,EAAA7B,MAAA;;;;"}