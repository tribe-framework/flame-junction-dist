{"version":3,"file":"input.js","sources":["../../../src/components/power-select-multiple/input.ts"],"sourcesContent":["import Component from '@glimmer/component';\nimport { action } from '@ember/object';\nimport { get } from '@ember/object';\nimport { assert } from '@ember/debug';\nimport { isBlank } from '@ember/utils';\nimport type { Select } from '../power-select';\n\ninterface PowerSelectMultipleInputSignature {\n  Element: HTMLElement;\n  Args: {\n    select: Select;\n    placeholder?: string;\n    searchField: string;\n    tabindex?: string;\n    listboxId?: string;\n    ariaLabel?: string;\n    ariaActiveDescendant?: string;\n    ariaLabelledBy?: string;\n    ariaDescribedBy?: string;\n    role?: string;\n    placeholderComponent?: string;\n    isDefaultPlaceholder?: boolean;\n    onInput?: (e: InputEvent) => boolean;\n    onKeydown?: (e: KeyboardEvent) => boolean;\n    onFocus: (e: FocusEvent) => void;\n    onBlur: (e: FocusEvent) => void;\n    buildSelection: (lastSelection: any, select: Select) => any[];\n  };\n}\n\nconst ua = window && window.navigator ? window.navigator.userAgent : '';\nconst isIE = ua.indexOf('MSIE ') > -1 || ua.indexOf('Trident/') > -1;\n\nexport default class PowerSelectMultipleInputComponent extends Component<PowerSelectMultipleInputSignature> {\n  get maybePlaceholder() {\n    if (isIE || !this.args.isDefaultPlaceholder) {\n      return undefined;\n    }\n    return !this.args.select.selected || this.args.select.selected.length === 0\n      ? this.args.placeholder || ''\n      : '';\n  }\n\n  @action\n  handleInput(event: Event): void {\n    const e = event as InputEvent;\n    if (this.args.onInput && this.args.onInput(e) === false) {\n      return;\n    }\n    this.args.select.actions.open(e);\n  }\n\n  @action\n  handleKeydown(event: Event): false | void {\n    const e = event as KeyboardEvent;\n    if (e.target === null) return;\n    if (this.args.onKeydown && this.args.onKeydown(e) === false) {\n      e.stopPropagation();\n      return false;\n    }\n    if (e.keyCode === 8) {\n      e.stopPropagation();\n      if (isBlank((e.target as HTMLInputElement).value)) {\n        const lastSelection =\n          this.args.select.selected &&\n          this.args.select.selected[this.args.select.selected.length - 1];\n        if (lastSelection) {\n          this.args.select.actions.select(\n            this.args.buildSelection(lastSelection, this.args.select),\n            e,\n          );\n          if (typeof lastSelection === 'string') {\n            this.args.select.actions.search(lastSelection);\n          } else {\n            assert(\n              '`<PowerSelectMultiple>` requires a `@searchField` when the options are not strings to remove options using backspace',\n              this.args.searchField,\n            );\n            this.args.select.actions.search(\n              get(lastSelection, this.args.searchField) || '',\n            );\n          }\n          this.args.select.actions.open(e);\n        }\n      }\n    } else if ((e.keyCode >= 48 && e.keyCode <= 90) || e.keyCode === 32) {\n      // Keys 0-9, a-z or SPACE\n      e.stopPropagation();\n    }\n  }\n}\n"],"names":["ua","window","navigator","userAgent","isIE","indexOf","PowerSelectMultipleInputComponent","Component","maybePlaceholder","args","isDefaultPlaceholder","undefined","select","selected","length","placeholder","handleInput","event","e","onInput","actions","open","n","prototype","action","handleKeydown","target","onKeydown","stopPropagation","keyCode","isBlank","value","lastSelection","buildSelection","search","assert","searchField","get","setComponentTemplate","TEMPLATE"],"mappings":"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"}